<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <head>
    <style>
      rect.bordered {
        stroke: #E6E6E6;
        stroke-width: 1;
      }
      text.mono {
        font-size: 9pt;
        font-family: Consolas, courier;
      }
      div.tooltip {
        position: absolute;
        text-align: left;
        width: auto;
        height: auto;
        padding: 10px;
        font: 12px sans-serif;
        background: #E5E5E5;
        border: 6px;
        border-radius: 8px;
        pointer-events: none;
      }
    </style>
    <script src="/d3.v3.js"></script>
    <script src="/render.js"></script>
  </head>
  <body>
    <div id="refseq_track"></div>
    <div id="coverage_track"></div>
    <div id="reads_track"></div>
    <script type="text/javascript">
      var margin = { top: 5, right: 0, bottom: 5, left: 30 }
          width = 960
          data = null;

      var tooltip = d3.select("body").append("div")
          .attr("class", "tooltip")
          .style("opacity", 0);

      initSVGs(width, margin,
               {div: "#refseq_track", height: 10},
               {div: "#coverage_track", height: 40},
               {div: "#reads_track", height: 500})

      d3.xhr("/reads")
          .header("Content-Type", "application/json")
          .post(JSON.stringify({
                  num_reads: 300,
                  chrom: 'chr1',
                  start: 0,
                  end: 80,
                  read_error_rate: 0.005
              }),
              function(err, request) {
                  if (err != undefined) {
                      document.write(err.response);
                      document.close();
                  }
                  data = JSON.parse(request.response);
                  gridSizeX = (width - margin.left - margin.right) / data.reference.length;
                  console.log("Data loaded");
                  render(data, gridSizeX);
              });
    </script>
  </body>
</html>
